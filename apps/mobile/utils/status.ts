// Enum for Status Codes
export enum StatusCode {
  // Information 1xx
  CONTINUE = 100,
  SWITCHING_PROTOCOLS = 101,
  PROCESSING = 102,
  EARLY_HINTS = 103,

  // Success 2xx
  SUCCESS = 200,
  CREATED = 201,
  ACCEPTED = 202,
  NO_CONTENT = 204,
  PARTIAL_CONTENT = 206,

  // Redirection 3xx
  MULTIPLE_CHOICES = 300,
  MOVED_PERMANENTLY = 301,
  FOUND = 302,
  SEE_OTHER = 303,
  NOT_MODIFIED = 304,
  TEMPORARY_REDIRECT = 307,
  PERMANENT_REDIRECT = 308,

  // Client Error 4xx
  BAD_REQUEST = 400,
  UNAUTHORIZED = 401,
  FORBIDDEN = 403,
  NOT_FOUND = 404,
  METHOD_NOT_ALLOWED = 405,
  REQUEST_TIMEOUT = 408,
  CONFLICT = 409,
  PAYLOAD_TOO_LARGE = 413,
  UNSUPPORTED_MEDIA_TYPE = 415,
  UNPROCESSABLE_ENTITY = 422,
  TOO_MANY_REQUESTS = 429,

  // Server Error 5xx
  INTERNAL_ERROR = 500,
  BAD_GATEWAY = 502,
  SERVICE_UNAVAILABLE = 503,
  GATEWAY_TIMEOUT = 504,
  HTTP_VERSION_NOT_SUPPORTED = 505,
  NETWORK_AUTHENTICATION_REQUIRED = 511,
}

export enum MessageCodes {
  // general
  SOMETHING_WENT_WRONG = 9999,
  SUCCESS = 1000,
  CREATED = 1001,
  BAD_REQUEST = 1002,
  UNAUTHORIZED = 1003,
  FORBIDDEN = 1004,
  NOT_FOUND = 1005,
  INTERNAL_ERROR = 1006,
  CONFLICT = 1007,
  UNPROCESSABLE_ENTITY = 1008,
  TOO_MANY_REQUESTS = 1009,

  // user related
  USER_NOT_FOUND = 3000,
  USER_ALREADY_EXISTS = 3001,
  USER_CREATED = 3002,
  USER_DELETED = 3003,
  USER_UPDATED = 3004,
  USER_FETCHED = 3005,
  USER_UNAUTHORIZED = 3006,
  SIGN_IN_SUCCESSFULLY = 3007,
  SIGN_OUT_SUCCESSFULLY = 3008,
  SIGN_UP_SUCCESSFULLY = 3009,
  SIGN_IN_FAILED = 3010,
  SIGN_UP_FAILED = 3011,
  SIGN_OUT_FAILED = 3012,
  WITHDRAW_SUCCESSFULLY = 3013,
  WITHDRAW_FAILED = 3014,
  MISSING_REQUIRED_FIELDS = 3015,

  // Supabase Specific Error Codes
  UNEXPECTED_FAILURE = 3100,
  VALIDATION_FAILED = 3101,
  BAD_JSON = 3102,
  EMAIL_ALREADY_EXISTS = 3103,
  PHONE_ALREADY_EXISTS = 3104,
  BAD_JWT = 3105,
  NOT_ADMIN = 3106,
  NO_AUTHORIZATION = 3107,
  SESSION_NOT_FOUND = 3108,
  SESSION_EXPIRED = 3109,
  REFRESH_TOKEN_NOT_FOUND = 3110,
  REFRESH_TOKEN_ALREADY_USED = 3111,
  FLOW_STATE_NOT_FOUND = 3112,
  FLOW_STATE_EXPIRED = 3113,
  SIGNUP_DISABLED = 3114,
  USER_BANNED = 3115,
  PROVIDER_EMAIL_NEEDS_VERIFICATION = 3116,
  INVITE_NOT_FOUND = 3117,
  BAD_OAUTH_STATE = 3118,
  BAD_OAUTH_CALLBACK = 3119,
  OAUTH_PROVIDER_NOT_SUPPORTED = 3120,
  UNEXPECTED_AUDIENCE = 3121,
  SINGLE_IDENTITY_NOT_DELETABLE = 3122,
  EMAIL_CONFLICT_IDENTITY_NOT_DELETABLE = 3123,
  IDENTITY_ALREADY_EXISTS = 3124,
  EMAIL_PROVIDER_DISABLED = 3125,
  PHONE_PROVIDER_DISABLED = 3126,
  TOO_MANY_ENROLLED_MFA_FACTORS = 3127,
  MFA_FACTOR_NAME_CONFLICT = 3128,
  MFA_FACTOR_NOT_FOUND = 3129,
  MFA_IP_ADDRESS_MISMATCH = 3130,
  MFA_CHALLENGE_EXPIRED = 3131,
  MFA_VERIFICATION_FAILED = 3132,
  MFA_VERIFICATION_REJECTED = 3133,
  INSUFFICIENT_AAL = 3134,
  CAPTCHA_FAILED = 3135,
  SAML_PROVIDER_DISABLED = 3136,
  MANUAL_LINKING_DISABLED = 3137,
  SMS_SEND_FAILED = 3138,
  EMAIL_NOT_CONFIRMED = 3139,
  PHONE_NOT_CONFIRMED = 3140,
  REAUTH_NONCE_MISSING = 3141,
  SAML_RELAY_STATE_NOT_FOUND = 3142,
  SAML_RELAY_STATE_EXPIRED = 3143,
  SAML_IDP_NOT_FOUND = 3144,
  SAML_ASSERTION_NO_USER_ID = 3145,
  SAML_ASSERTION_NO_EMAIL = 3146,
  SSO_PROVIDER_NOT_FOUND = 3147,
  SAML_METADATA_FETCH_FAILED = 3148,
  SAML_IDP_ALREADY_EXISTS = 3149,
  SSO_DOMAIN_ALREADY_EXISTS = 3150,
  SAML_ENTITY_ID_MISMATCH = 3151,
  SUPABASE_CONFLICT = 3152,
  PROVIDER_DISABLED = 3153,
  USER_SSO_MANAGED = 3154,
  REAUTHENTICATION_NEEDED = 3155,
  SAME_PASSWORD = 3156,
  REAUTHENTICATION_NOT_VALID = 3157,
  OTP_EXPIRED = 3158,
  OTP_DISABLED = 3159,
  IDENTITY_NOT_FOUND = 3160,
  WEAK_PASSWORD = 3161,
  OVER_REQUEST_RATE_LIMIT = 3162,
  OVER_EMAIL_SEND_RATE_LIMIT = 3163,
  OVER_SMS_SEND_RATE_LIMIT = 3164,
  BAD_CODE_VERIFIER = 3165,
  ANONYMOUS_PROVIDER_DISABLED = 3166,
  HOOK_TIMEOUT = 3167,
  HOOK_TIMEOUT_AFTER_RETRY = 3168,
  HOOK_PAYLOAD_OVER_SIZE_LIMIT = 3169,
  HOOK_PAYLOAD_INVALID_CONTENT_TYPE = 3170,
  REQUEST_TIMEOUT = 3171,
  MFA_PHONE_ENROLL_NOT_ENABLED = 3172,
  MFA_PHONE_VERIFY_NOT_ENABLED = 3173,
  MFA_TOTP_ENROLL_NOT_ENABLED = 3174,
  MFA_TOTP_VERIFY_NOT_ENABLED = 3175,
  MFA_WEBAUTHN_ENROLL_NOT_ENABLED = 3176,
  MFA_WEBAUTHN_VERIFY_NOT_ENABLED = 3177,
  MFA_VERIFIED_FACTOR_EXISTS = 3178,
  INVALID_CREDENTIALS = 3179,
  EMAIL_ADDRESS_NOT_AUTHORIZED = 3180,
  EMAIL_ADDRESS_INVALID = 3181,

  UNKNOWN_ERROR = 3999,

  // pray related
  PRAY_NOT_FOUND = 4000,
  PRAY_CREATED = 4001,
  PRAY_DELETED = 4002,
  PRAY_UPDATED = 4003,
  PRAY_FETCHED = 4004,

  // friend related
  FRIEND_NOT_FOUND = 5000,
  FRIEND_APPROVED = 5001,
  FRIEND_DELETED = 5002,
  FRIEND_REQUESTED = 5003,
  FRIEND_FETCHED = 5004,
  FRIEND_EXISTS = 5005,
  FRIEND_CANCELLED = 5006,
  FRIEND_REJECTED = 5007,
  FRIEND_FRIENDSHIP_NOT_FOUND = 5008,

  // award related
  AWARD_NOT_FOUND = 6000,
  AWARD_CREATED = 6001,
  AWARD_DELETED = 6002,
  AWARD_UPDATED = 6003,
  AWARD_FETCHED = 6004,

  // SUBSCRIPTIONS
  PACKAGE_NOT_FOUND = 7000,
  PACKAGE_CREATED = 7001,
  PACKAGE_DELETED = 7002,
  PACKAGE_UPDATED = 7003,
  PACKAGE_FETCHED = 7004,
  PACKAGE_EXISTS = 7005,
  PACKAGE_CANCELLED = 7006,
  PACKAGE_REJECTED = 7007,
  PACKAGE_SUBSCRIPTION_NOT_FOUND = 7008,
}

export const SupabaseErrorMap: Record<string, MessageCodes> = {
  unexpected_failure: MessageCodes.UNEXPECTED_FAILURE,
  validation_failed: MessageCodes.VALIDATION_FAILED,
  bad_json: MessageCodes.BAD_JSON,
  email_exists: MessageCodes.EMAIL_ALREADY_EXISTS,
  phone_exists: MessageCodes.PHONE_ALREADY_EXISTS,
  bad_jwt: MessageCodes.BAD_JWT,
  not_admin: MessageCodes.NOT_ADMIN,
  no_authorization: MessageCodes.NO_AUTHORIZATION,
  user_not_found: MessageCodes.USER_NOT_FOUND,
  session_not_found: MessageCodes.SESSION_NOT_FOUND,
  session_expired: MessageCodes.SESSION_EXPIRED,
  refresh_token_not_found: MessageCodes.REFRESH_TOKEN_NOT_FOUND,
  refresh_token_already_used: MessageCodes.REFRESH_TOKEN_ALREADY_USED,
  flow_state_not_found: MessageCodes.FLOW_STATE_NOT_FOUND,
  flow_state_expired: MessageCodes.FLOW_STATE_EXPIRED,
  signup_disabled: MessageCodes.SIGNUP_DISABLED,
  user_banned: MessageCodes.USER_BANNED,
  provider_email_needs_verification: MessageCodes.PROVIDER_EMAIL_NEEDS_VERIFICATION,
  invite_not_found: MessageCodes.INVITE_NOT_FOUND,
  bad_oauth_state: MessageCodes.BAD_OAUTH_STATE,
  bad_oauth_callback: MessageCodes.BAD_OAUTH_CALLBACK,
  oauth_provider_not_supported: MessageCodes.OAUTH_PROVIDER_NOT_SUPPORTED,
  unexpected_audience: MessageCodes.UNEXPECTED_AUDIENCE,
  single_identity_not_deletable: MessageCodes.SINGLE_IDENTITY_NOT_DELETABLE,
  email_conflict_identity_not_deletable: MessageCodes.EMAIL_CONFLICT_IDENTITY_NOT_DELETABLE,
  identity_already_exists: MessageCodes.IDENTITY_ALREADY_EXISTS,
  email_provider_disabled: MessageCodes.EMAIL_PROVIDER_DISABLED,
  phone_provider_disabled: MessageCodes.PHONE_PROVIDER_DISABLED,
  too_many_enrolled_mfa_factors: MessageCodes.TOO_MANY_ENROLLED_MFA_FACTORS,
  mfa_factor_name_conflict: MessageCodes.MFA_FACTOR_NAME_CONFLICT,
  mfa_factor_not_found: MessageCodes.MFA_FACTOR_NOT_FOUND,
  mfa_ip_address_mismatch: MessageCodes.MFA_IP_ADDRESS_MISMATCH,
  mfa_challenge_expired: MessageCodes.MFA_CHALLENGE_EXPIRED,
  mfa_verification_failed: MessageCodes.MFA_VERIFICATION_FAILED,
  mfa_verification_rejected: MessageCodes.MFA_VERIFICATION_REJECTED,
  insufficient_aal: MessageCodes.INSUFFICIENT_AAL,
  captcha_failed: MessageCodes.CAPTCHA_FAILED,
  saml_provider_disabled: MessageCodes.SAML_PROVIDER_DISABLED,
  manual_linking_disabled: MessageCodes.MANUAL_LINKING_DISABLED,
  sms_send_failed: MessageCodes.SMS_SEND_FAILED,
  email_not_confirmed: MessageCodes.EMAIL_NOT_CONFIRMED,
  phone_not_confirmed: MessageCodes.PHONE_NOT_CONFIRMED,
  email_address_not_authorized: MessageCodes.EMAIL_ADDRESS_NOT_AUTHORIZED,
  email_address_invalid: MessageCodes.EMAIL_ADDRESS_INVALID,
  weak_password: MessageCodes.WEAK_PASSWORD,
  over_request_rate_limit: MessageCodes.OVER_REQUEST_RATE_LIMIT,
  request_timeout: MessageCodes.REQUEST_TIMEOUT,
  reauthentication_needed: MessageCodes.REAUTHENTICATION_NEEDED,
  otp_expired: MessageCodes.OTP_EXPIRED,
  otp_disabled: MessageCodes.OTP_DISABLED,
  provider_disabled: MessageCodes.PROVIDER_DISABLED,
  hook_timeout: MessageCodes.HOOK_TIMEOUT,
  hook_timeout_after_retry: MessageCodes.HOOK_TIMEOUT_AFTER_RETRY,
  hook_payload_over_size_limit: MessageCodes.HOOK_PAYLOAD_OVER_SIZE_LIMIT,
  hook_payload_invalid_content_type: MessageCodes.HOOK_PAYLOAD_INVALID_CONTENT_TYPE,
  conflict: MessageCodes.SUPABASE_CONFLICT,
  invalid_credentials: MessageCodes.INVALID_CREDENTIALS,
};

// Default message code if an error isn't mapped
export const DEFAULT_MESSAGE_CODE = MessageCodes.UNKNOWN_ERROR;

// Response Utility Function
export function createResponse<T>({
  status,
  message,
  code,
  data = null,
}: {
  status: StatusCode;
  message: string;
  code?: MessageCodes;
  data: T | null;
}) {
  return new Response(
    JSON.stringify({
      status,
      message,
      code,
      data,
    }),
    { status }
  );
}
